id: users_hard_005
category: users_groups
difficulty: hard
task: |
  Create a system user 'serviceaccount' with no login shell (/sbin/nologin).
  The user should have no home directory and UID below 1000.

points: 20
time_limit: 600

setup_commands:
  - "userdel -r serviceaccount 2>/dev/null || true"

validation:
  checks:
    - type: command
      command: "id serviceaccount"
      regex_match: "uid="
      description: "User serviceaccount exists"
    
    - type: command
      command: "id -u serviceaccount"
      regex_match: "^[0-9]{1,3}$"
      description: "UID is below 1000"
    
    - type: command
      command: "getent passwd serviceaccount | cut -d: -f7"
      regex_match: "/sbin/nologin|/usr/sbin/nologin"
      description: "Shell is nologin"

hints:
  - "Use 'useradd -r -s /sbin/nologin -M serviceaccount'"
  - "The -r flag creates a system user"
  - "The -M flag prevents home directory creation"
  - "The -s flag sets the shell"

tags:
  - users_groups
  - system_users
  - security
  - advanced

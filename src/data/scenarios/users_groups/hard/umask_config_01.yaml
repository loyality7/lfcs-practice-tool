id: users_hard_003
category: users_groups
difficulty: hard
task: |
  Set the default umask to 027 for all users by modifying /etc/profile.
  Verify by creating /tmp/{{ random_file }} and checking its permissions.

points: 20
time_limit: 600

setup_commands:
  - "sed -i '/umask 027/d' /etc/profile 2>/dev/null || true"
  - "rm -f /tmp/{{ random_file }} 2>/dev/null || true"

validation:
  checks:
    - type: command
      command: "grep 'umask 027' /etc/profile"
      regex_match: "umask 027"
      description: "Umask 027 is set in /etc/profile"
    
    - type: file
      path: "/tmp/{{ random_file }}"
      should_exist: true
      description: "Test file exists"

hints:
  - "Add to /etc/profile: echo 'umask 027' >> /etc/profile"
  - "Source the file: source /etc/profile"
  - "Create test file: touch /tmp/{{ random_file }}"
  - "Check permissions: ls -l /tmp/{{ random_file }} (should be 640)"

tags:
  - users_groups
  - umask
  - security
  - advanced

id: advanced_user_setup_01
category: users_groups
difficulty: hard
task: |
  Create a new user 'devuser' with the following requirements:
  - UID: 3000
  - Primary group: developers (GID: 3000)
  - Additional groups: docker, sudo
  - Home directory: /home/devuser
  - Shell: /bin/bash
  - Home directory should be owned by the user
  
  Create the 'developers' group if it doesn't exist.

setup_commands:
  - "groupadd -g 3000 developers 2>/dev/null || true"
  - "groupadd docker 2>/dev/null || true"

validation:
  checks:
    - type: custom
      script_path: /validation/validate_user_setup.py
      args: ["devuser", "3000", "developers,docker,sudo"]
      expected_exit_code: 0
      description: "Validate complete user configuration"
    
    - type: command
      command: "id devuser"
      regex_match: "uid=3000.*gid=3000.*groups=.*developers.*docker.*sudo"
      description: "User has correct UID, GID, and group memberships"
    
    - type: file
      path: /home/devuser
      should_exist: true
      owner: devuser
      description: "Home directory exists and is owned by user"

points: 100
hints:
  - "Use 'useradd' with appropriate flags for UID and groups"
  - "The -g flag sets primary group, -G sets additional groups"
  - "Use 'id username' to verify user configuration"
  - "Home directory is created automatically with -m flag"
tags:
  - users
  - groups
  - user-management
  - permissions

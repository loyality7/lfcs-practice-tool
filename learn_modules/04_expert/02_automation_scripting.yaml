id: automation_scripting_02
level: expert
title: "Automation & Shell Scripting"
description: "Master bash scripting, cron jobs, and automation"
estimated_time: 55

lessons:
  - id: lesson_01
    title: "Bash Scripting Basics"
    notes: |
      ğŸ“œ Shell Scripting Fundamentals
      
      Script Structure:
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      #!/bin/bash
      # Comments start with #
      
      echo "Hello World"
      
      Variables:
      â”€â”€â”€â”€â”€â”€â”€â”€â”€
      â€¢ name="John"           - Assign variable
      â€¢ echo $name            - Use variable
      â€¢ echo ${name}          - Safer syntax
      â€¢ readonly PI=3.14      - Read-only variable
      
      Command Substitution:
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      â€¢ output=$(command)
      â€¢ output=`command`      - Old syntax
      â€¢ date=$(date +%Y-%m-%d)
      
      Conditionals:
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      if [ condition ]; then
          commands
      elif [ condition ]; then
          commands
      else
          commands
      fi
      
      Test Operators:
      â€¢ -eq  - Equal
      â€¢ -ne  - Not equal
      â€¢ -gt  - Greater than
      â€¢ -lt  - Less than
      â€¢ -f   - File exists
      â€¢ -d   - Directory exists
      â€¢ -z   - String is empty
      
      Loops:
      â”€â”€â”€â”€â”€
      for i in 1 2 3; do
          echo $i
      done
      
      while [ condition ]; do
          commands
      done
    
    exercises:
      - id: ex_01
        type: command
        description: "Create a simple script that prints hostname"
        command: echo '#!/bin/bash' > myscript.sh && echo 'hostname' >> myscript.sh && chmod +x myscript.sh && ./myscript.sh
        validation:
          type: file
          path: "./myscript.sh"
        hints:
          - "Create file: echo '#!/bin/bash' > myscript.sh"
          - "Add command: echo 'hostname' >> myscript.sh"
          - "Make executable: chmod +x myscript.sh"
        points: 25

  - id: lesson_02
    title: "Cron Jobs"
    notes: |
      â° Scheduled Tasks with Cron
      
      Crontab Syntax:
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      * * * * * command
      â”‚ â”‚ â”‚ â”‚ â”‚
      â”‚ â”‚ â”‚ â”‚ â””â”€ Day of week (0-7, 0=Sunday)
      â”‚ â”‚ â”‚ â””â”€â”€â”€ Month (1-12)
      â”‚ â”‚ â””â”€â”€â”€â”€â”€ Day of month (1-31)
      â”‚ â””â”€â”€â”€â”€â”€â”€â”€ Hour (0-23)
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€ Minute (0-59)
      
      Commands:
      â”€â”€â”€â”€â”€â”€â”€â”€
      â€¢ crontab -l            - List cron jobs
      â€¢ crontab -e            - Edit cron jobs
      â€¢ crontab -r            - Remove all jobs
      â€¢ crontab -u user -l    - List user's jobs
      
      Examples:
      â€¢ 0 2 * * * /backup.sh  - Daily at 2 AM
      â€¢ */5 * * * * /check.sh - Every 5 minutes
      â€¢ 0 0 * * 0 /weekly.sh  - Weekly on Sunday
      â€¢ 0 9-17 * * 1-5 /work.sh - Weekdays 9AM-5PM
      
      Special Strings:
      â€¢ @reboot /script.sh    - Run at boot
      â€¢ @daily /script.sh     - Run daily
      â€¢ @weekly /script.sh    - Run weekly
      â€¢ @monthly /script.sh   - Run monthly
      
      System Cron:
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      â€¢ /etc/crontab          - System crontab
      â€¢ /etc/cron.d/          - Additional cron files
      â€¢ /etc/cron.daily/      - Daily scripts
      â€¢ /etc/cron.weekly/     - Weekly scripts
      â€¢ /etc/cron.monthly/    - Monthly scripts
    
    exercises:
      - id: ex_02
        type: command
        description: "List current user's cron jobs"
        command: crontab -l 2>/dev/null || echo "no crontab for $(whoami)"
        hints:
          - "Use: crontab -l"
        points: 15
      
      - id: ex_03
        type: command
        description: "Check if cron service is running"
        command: systemctl is-active cron || systemctl is-active crond
        hints:
          - "Use: systemctl is-active cron"
          - "On some systems: systemctl is-active crond"
        points: 15

  - id: lesson_03
    title: "Systemd Timers"
    notes: |
      â²ï¸ Modern Scheduling with Systemd
      
      Systemd timers replace cron jobs with more features!
      
      Timer Units:
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      â€¢ systemctl list-timers - List all timers
      â€¢ systemctl status timer.timer
      â€¢ systemctl start timer.timer
      â€¢ systemctl enable timer.timer
      
      Creating a Timer:
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      1. Create service file: /etc/systemd/system/backup.service
      2. Create timer file: /etc/systemd/system/backup.timer
      3. Enable timer: systemctl enable backup.timer
      4. Start timer: systemctl start backup.timer
      
      Timer Example (backup.timer):
      [Unit]
      Description=Backup Timer
      
      [Timer]
      OnCalendar=daily
      Persistent=true
      
      [Install]
      WantedBy=timers.target
      
      OnCalendar Examples:
      â€¢ OnCalendar=daily        - Every day at midnight
      â€¢ OnCalendar=weekly       - Every Monday
      â€¢ OnCalendar=*:0/15       - Every 15 minutes
      â€¢ OnCalendar=Mon *-*-* 09:00:00 - Mondays at 9 AM
    
    exercises:
      - id: ex_04
        type: command
        description: "List all active systemd timers"
        command: systemctl list-timers
        expected_pattern: "NEXT|LEFT|LAST"
        hints:
          - "Use: systemctl list-timers"
        points: 20

completion_criteria:
  min_exercises_completed: 3
  min_score: 60

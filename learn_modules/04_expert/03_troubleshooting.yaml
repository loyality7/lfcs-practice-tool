id: troubleshooting_03
level: expert
title: "System Troubleshooting"
description: "Master debugging and troubleshooting techniques"
estimated_time: 45

lessons:
  - id: lesson_01
    title: "Boot Troubleshooting"
    notes: |
      ðŸ”§ Boot Process Debugging
      
      GRUB Troubleshooting:
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      â€¢ grub2-mkconfig -o /boot/grub2/grub.cfg
      â€¢ update-grub           - Ubuntu/Debian
      â€¢ grub2-install /dev/sda - Reinstall GRUB
      
      Boot Parameters:
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      â€¢ systemd.unit=rescue.target    - Rescue mode
      â€¢ systemd.unit=emergency.target - Emergency mode
      â€¢ init=/bin/bash                - Single user
      â€¢ rd.break                      - Break at initramfs
      
      Systemd Boot Analysis:
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      â€¢ systemd-analyze       - Boot time
      â€¢ systemd-analyze blame - Time per service
      â€¢ systemd-analyze critical-chain - Dependency chain
      â€¢ systemd-analyze plot > boot.svg - Visual timeline
      
      Recovery:
      â”€â”€â”€â”€â”€â”€â”€â”€
      â€¢ systemctl rescue      - Enter rescue mode
      â€¢ systemctl emergency   - Enter emergency mode
      â€¢ systemctl default     - Return to default target
    
    exercises:
      - id: ex_01
        type: command
        description: "Check system boot time"
        command: systemd-analyze
        expected_pattern: "Startup finished"
        hints:
          - "Use: systemd-analyze"
        points: 15
      
      - id: ex_02
        type: command
        description: "Show which services slow down boot"
        command: systemd-analyze blame | head -10
        hints:
          - "Use: systemd-analyze blame | head -10"
        points: 20

  - id: lesson_02
    title: "Performance Analysis"
    notes: |
      ðŸ“ˆ System Performance Tools
      
      sar - System Activity Reporter:
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      â€¢ sar -u 1 5            - CPU usage (1s interval, 5 times)
      â€¢ sar -r 1 5            - Memory usage
      â€¢ sar -b 1 5            - I/O stats
      â€¢ sar -n DEV 1 5        - Network stats
      
      vmstat - Virtual Memory Stats:
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      â€¢ vmstat 1 10           - Every 1 second, 10 times
      â€¢ vmstat -s             - Summary
      â€¢ vmstat -d             - Disk stats
      
      iostat - I/O Statistics:
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      â€¢ iostat                - Basic I/O stats
      â€¢ iostat -x 1 5         - Extended stats
      â€¢ iostat -d 1 5         - Disk only
      
      mpstat - CPU Statistics:
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      â€¢ mpstat                - Overall CPU
      â€¢ mpstat -P ALL         - Per-CPU stats
      â€¢ mpstat 1 5            - Every 1 second
      
      strace - System Call Trace:
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      â€¢ strace command        - Trace system calls
      â€¢ strace -p PID         - Trace running process
      â€¢ strace -c command     - Count calls
      â€¢ strace -e open command - Trace specific call
      
      lsof - List Open Files:
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      â€¢ lsof                  - All open files
      â€¢ lsof -u user          - User's files
      â€¢ lsof -i :80           - Files using port 80
      â€¢ lsof -p PID           - Process's files
    
    exercises:
      - id: ex_03
        type: command
        description: "Show virtual memory statistics"
        command: vmstat 1 3
        expected_pattern: "procs|memory|swap"
        hints:
          - "Use: vmstat 1 3"
        points: 20

  - id: lesson_03
    title: "Log Analysis"
    notes: |
      ðŸ“‹ Analyzing System Logs
      
      Log Locations:
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      â€¢ /var/log/syslog       - General system logs
      â€¢ /var/log/messages     - System messages (RHEL)
      â€¢ /var/log/auth.log     - Authentication logs
      â€¢ /var/log/secure       - Security logs (RHEL)
      â€¢ /var/log/kern.log     - Kernel logs
      â€¢ /var/log/dmesg        - Boot messages
      
      dmesg - Kernel Ring Buffer:
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      â€¢ dmesg                 - All kernel messages
      â€¢ dmesg | tail          - Recent messages
      â€¢ dmesg -l err          - Errors only
      â€¢ dmesg -T              - Human-readable timestamps
      â€¢ dmesg -w              - Watch for new messages
      
      journalctl Advanced:
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      â€¢ journalctl -xe        - Recent with explanations
      â€¢ journalctl -k         - Kernel messages only
      â€¢ journalctl --vacuum-time=2weeks - Clean old logs
      â€¢ journalctl --verify   - Verify log integrity
      
      Log Analysis Tools:
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      â€¢ grep -i error /var/log/syslog
      â€¢ tail -f /var/log/syslog | grep error
      â€¢ awk '/error/ {print $0}' /var/log/syslog
      â€¢ logwatch              - Automated log analysis
    
    exercises:
      - id: ex_04
        type: command
        description: "Show recent kernel messages"
        command: dmesg | tail -20
        hints:
          - "Use: dmesg | tail -20"
        points: 15
      
      - id: ex_05
        type: command
        description: "Search for errors in journal"
        command: journalctl -p err -n 10
        hints:
          - "Use: journalctl -p err -n 10"
          - "-p err shows error priority"
          - "-n 10 shows last 10 entries"
        points: 20

completion_criteria:
  min_exercises_completed: 4
  min_score: 70

id: users_hard_002
category: users_groups
difficulty: hard
task: |
  Create a user 'secureuser' and configure password aging:
  - Minimum password age: 7 days
  - Maximum password age: 90 days
  - Warning period: 14 days before expiration

points: 20
time_limit: 600

setup_commands:
  - "userdel -r secureuser 2>/dev/null || true"

validation:
  checks:
    - type: command
      command: "id secureuser"
      regex_match: "uid="
      description: "User secureuser exists"
    
    - type: command
      command: "chage -l secureuser | grep 'Minimum number of days' | grep '7'"
      regex_match: "7"
      description: "Minimum password age is 7 days"
    
    - type: command
      command: "chage -l secureuser | grep 'Maximum number of days' | grep '90'"
      regex_match: "90"
      description: "Maximum password age is 90 days"
    
    - type: command
      command: "chage -l secureuser | grep 'Number of days of warning' | grep '14'"
      regex_match: "14"
      description: "Warning period is 14 days"

hints:
  - "Create user: useradd secureuser"
  - "Set minimum age: chage -m 7 secureuser"
  - "Set maximum age: chage -M 90 secureuser"
  - "Set warning: chage -W 14 secureuser"
  - "Verify with: chage -l secureuser"

tags:
  - users_groups
  - password_policy
  - security
  - advanced
